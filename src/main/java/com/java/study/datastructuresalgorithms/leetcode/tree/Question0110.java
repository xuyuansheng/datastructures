package com.java.study.datastructuresalgorithms.leetcode.tree;

import lombok.Data;
import lombok.experimental.Accessors;

import java.math.BigDecimal;

/**
 * 110. 平衡二叉树
 * <p>
 * 给定一个二叉树，判断它是否是高度平衡的二叉树。
 * <p>
 * 本题中，一棵高度平衡二叉树定义为：
 *
 * @author Mr.Xu
 * @date 2020/3/7 16:47
 */
public class Question0110 {


    public static void main(String[] args) {
        Integer[] nums = new Integer[]{-283, -1721, 1813, 2839, 61, -1030, 2824, 185, 2616, -1609, 1647, -977, -424, 2266, 2320, -410, 1337, 1256, 422, -964, 577, 2411, 496, 1366, -1286, 2814, -966, 2930, 1020, 1058, 1441, -814, -975, null, null, 2325, 1832, -1158, -1148, -1779, 943, -1069, -542, 1201, -678, -1560, 1949, null, -1579, null, -1130, 2726, -793, -5, -1086, 668, -634, 1554, 291, 2483, -209, 1459, -1292, null, null, null, 2144, 2224, 2098, -192, 729, 733, 2828, null, null, 1121, 2074, null, -809, -557, null, null, null, null, -965, 197, -1965, null, 1907, -1552, 2133, null, 1844, null, 2475, 1118, 2625, 151, 2315, 97, -572, 1048, -1752, -820, 522, -1559, 2880, -1485, -955, 711, 1483, 2647, -1151, 2745, 160, null, 1531, 2348, -8, null, null, null, null, null, 1640, null, null, null, null, null, 411, null, -1555, null, 2810, null, null, 1481, null, -1002, null, null, 2633, 48, 347, 701, 2678, -372, 1407, null, null, null, null, null, null, 1061, null, -798, -1089, -1009, 2542, -762, 1901, -1171, 1706, 242, -258, -1316, 1041, 2580, null, -870, null, -317, 2476, 1643, 1698, -3, null, 2953, 243, 1520, -675, -709, 2538, -1688, 1035, 658, -1052, -30, -409, -577, 2020, 465, -1988, -383, -1348, -982, -960, null, null, -1363, -549, null, 1513, -1513, null, 2060, 1421, -937, -1147, 2629, null, null, null, null, null, 1528, 965, 2860, -458, 845, null, null, 1224, null, null, -127, null, -1269, 795, 427, null, 791, -1375, 1050, -1035, null, -586, null, -477, 2817, -1854, null, null, null, null, -1502, -450, null, null, -1731, 317, -1772, -1590, -1538, 2209, 695, null, 1160, 209, 2473, -663, null, 2032, 2261, 1962, null, null, null, null, 908, -1303, 1888, -833, -1203, 2435, -666, 423, 1959, -1755, -362, 2496, -1137, -120, -485, 2576, 989, 2679, -1614, 945, -10, 1619, 2485, 256, -972, null, 2165, -726, 865, null, 553, null, null, 1825, 2177, -1534, null, null, -811, 1090, 2868, -1351, null, null, null, 2852, -1594, -1666, -1474, null, 206, 471, 282, null, null, 2689, -1230, -1317, 321, 2279, 1382, -1845, null, null, null, null, null, null, null, null, 1307, null, null, null, 315, -1120, -920, -1356, 2488, 847, null, -59, -1104, -790, -1633, -835, null, null, null, null, 1447, 2935, null, 2687, 2621, null, -521, null, -1105, 1746, null, 2719, -539, 1563, null, 557, null, -49, null, null, -1754, 247, null, -1927, 992, -911, null, null, null, null, null, null, null, null, 1692, 254, 2920, null, -396, 2701, null, null, -1540, 1569, 1667, 1333, -333, -555, 2202, 2362, 2056, -730, -1676, 2176, null, 1574, -1016, 154, -35, 2892, null, 648, null, null, null, null, 2001, 153, 114, 1833, 2482, 2885, 565, -950, null, 1075, 2474, -1515, 2016, null, -1116, -1218, 529, null, -321, 363, -306, 1202, 2059, 801, null, 2366, 255, -159, 1711, null, 2520, -1354, -1570, 917, 442, 1742, null, null, null, 1932, null, null, 1429, 2308, null, 146, null, null, 1573, 1410, 1807, 1129, null, 1189, null, null, 2951, null, 780, -385, null, 41, null, null, 2493, null, -1421, null, null, null, null, null, -1349, 673, null, 2136, null, -1729, null, -1015, 1963, 1578, null, 1702, -23, null, null, 2722, null, null, null, 1391, -676, null, 2070, 279, 1765, -1144, -1166, -1819, 1436, -1934, -1484, 326, null, null, null, 1875, -1696, -217, 1163, null, -94, null, 1486, 1928, null, -324, null, null, null, 1412, 2938, -750, -1220, null, 2272, null, null, null, 1082, -1829, 2300, 1326, 2204, -1759, -1828, -1005, 1260, -145, -162, -1234, 1315, -1176, 1084, 1694, -580, 1768, null, null, 1328, 1435, 1161, -1801, 2821, 2677, 916, -1128, -1357, 1726, null, null, 1490, null, 691, 652, 2741, 1389, null, null, null, 1398, null, -332, null, null, -32, 1068, null, -202, -1020, 2891, 2457, -405, null, null, 1130, 1773, 1493, 2736, -1853, 2666, 2511, null, 1930, 2972, null, null, null, null, 838, null, 2754, 2198, -1102, 2743, 370, -176, null, 2167, 644, null, 1488, 2975, null, 1827, 1956, 2379, -1022, null, null, -359, -742, null, null, 618, -1000, -551, null, null, 2984, 807, null, null, 261, null, null, 30, 1002, 2407, 744, -246, 902, null, 1401, 1348, null, null, null, null, null, null, 1291, -1238, null, null, null, null, -1092, -1478, null, null, null, null, 2811, null, null, null, -260, -1447, null, null, null, null, -1602, null, 1623, null, null, 1104, -1899, null, null, null, null, null, null, null, 301, null, 121, null, -1249, null, null, -1737, null, null, null, null, null, 1409, -190, null, 2704, 1652, null, null, null, null, null, 446, -1117, -509, 2227, null, null, null, null, null, -1174, null, 387, -1323, null, null, null, 1383, -1501, null, -840, null, null, -1844, null, null, null, 2265, 942, 1174, -128, 402, -1840, -1079, null, null, null, 104, -1674, -207, null, null, 244, 1124, null, null, null, null, null, null, null, -472, -63, -1167, -1660, 952, null, 2414, 92, -1621, 1802, 854, 191, null, 2771, -339, 1251, 251, 1433, -274, null, -808, 2067, -1529, 2041, 2200, -828, -906, null, null, null, 2353, null, -235, null, null, 1289, 1463, null, -58, -1077, 1194, null, -804, 125, -978, 17, null, null, null, 1280, null, null, 2948, null, -72, 2877, null, 2363, -1630, null, -795, 400, -644, -188, -91, -251, -1811, null, null, 1806, 2247, 218, 1525, -1856, -1418, 351, 214, 1748, -1027, -492, 1764, 2865, null, 1427, 582, null, null, null, null, null, -48, 2697, null, -334, null, -1973, null, -264, null, null, -1209, -1868, -134, null, null, 265, -1285, null, null, 2342, 1107, 2206, null, null, -1823, 2909, -993, -347, 1501, 709, null, 123, -1940, null, null, null, null, -698, null, null, null, null, null, null, null, null, null, -1477, null, null, null, 1512, null, null, -1463, null, null, null, 881, null, -1797, null, null, 2545, null, -1103, null, 1988, null, null, null, -1406, 2729, null, null, null, -1450, 1778, null, null, null, 2242, -908, 63, 2509, -270, null, null, null, -1438, null, 2079, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, -1957, null, 2304, 2234, 1731, 783, 2521, 1543, -1979, 616, null, 1997, 1892, -1397, -1224, -1140, null, null, -1223, null, null, 2968, 832, 2600, null, 2619, -116, -1800, 2048, 2464, 1162, null, -1006, 177, null, 2409, -874, 2573, -309, 228, -1473, 993, 2180, 1088, 512, -1898, -944, -1332, -1391, 2495, 2524, null, -1795, null, null, null, -1698, 2284, null, -788, 1564, -941, 876, 2974, null, 578, -1619, null, null, -1970, null, null, -526, 1908, null, null, null, 2413, null, -740, null, null, null, null, null, null, -1642, null, 2513, null, null, null, 439, null, null, null, -1453, null, null, null, -1843, null, -844, null, null, null, null, 656, 2728, null, null, null, null, -1686, 2415, null, 1193, null, null, 928, 26, null, null, -1605, null, 2598, -1551, null, -751, null, 365, null, -723, null, null, null, -203, null, null, null, null, null, 1468, 2717, 385, -34, null, -873, -1663, null, 2775, null, null, null, null, 1620, -1992, null, -1687, null, -1049, null, null, null, null, null, 33, -1446, -871, null, null, null, null, null, null, null, null, null, -1863, 1686, -239, null, null, null, null, null, -131, null, null, null, 2651, null, null, 2553, null, null, 1269, null, null, 2789, null, null, null, null, null, -1497, 1140, null, 2593, 180, null, 2518, null, null, 1965, null, null, null, 1196, null, null, null, null, -247, -20, 2219, null, null, null, 1641, -1177, null, null, 447, -1761, 2375, 2425, null, 2249, null, 2078, -1577, null, null, -1195, null, 1675, 2917, 1103, null, -51, -1595, 933, null, -1253, null, 861, null, -310, null, -389, null, null, null, null, null, -894, null, null, -1872, -272, null, -649, null, null, null, null, null, null, 1668, null, 726, -507, 2324, -517, null, 2029, null, null, null, null, null, null, null, null, -175, 2991, 2735, 2492, -736, -528, -807, 1156, 1418, 1115, null, null, -1159, null, 2832, -830, -538, -1547, null, 2797, -294, -925, 330, null, 2857, null, null, null, 1489, 1745, null, -562, 525, null, null, null, 532, -1873, null, 2368, null, null, 2780, 1455, -1837, 1912, null, -1580, null, null, null, -1021, null, -1815, null, null, 95, null, null, null, 1636, 1093, null, null, null, 409, null, null, null, 1252, null, 1223, 1231, 898, 2867, null, 1878, -1071, null, 58, null, null, null, null, null, null, null, null, -1008, 721, -358, 526, null, null, null, null, null, null, null, null, 2623, null, null, 2849, 1801, null, 2929, null, null, -377, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 1099, 348, null, null, null, 2271, 175, null, null, -1053, null, -1060, null, null, null, null, null, -54, null, null, null, null, null, null, 1470, null, 2591, null, null, null, null, 1506, null, null, null, null, 155, 2281, null, 679, 973, -1490, 501, 825, 2748, null, -752, null, 2958, 1212, null, 2115, 253, null, -779, null, null, -495, null, null, null, null, null, 2065, -1915, null, null, null, null, null, null, null, -1216, null, null, -707, null, null, null, -473, -1374, null, null, null, null, 1460, 2139, 2244, -1353, -725, null, null, -945, -37, null, 1190, null, -939, null, null, 1683, null, -257, -277, 2007, 1443, -771, null, 2294, -425, 1076, 811, 1112, -857, null, -1708, null, null, 936, 2335, -1202, 1448, -414, 2346, null, null, 2312, null, null, null, null, null, 2543, -922, 429, null, null, -292, 1151, -1082, null, null, null, null, null, 619, 2550, null, 267, null, null, 2554, null, null, null, null, 1081, null, -1990, null, null, null, 2128, null, 2954, null, -1542, 2220, 1247, null, null, null, null, 2472, null, null, 1191, null, null, -1678, 1865, -713, null, null, 2064, null, null, null, 2547, null, null, null, null, null, null, -588, null, 821, null, 2097, null, null, -1949, null, null, null, null, null, null, null, null, 2396, -903, null, null, null, null, null, -708, 27, null, null, null, null, null, null, -1156, null, -265, -376, null, null, null, null, 890, null, null, null, 1454, null, null, null, null, null, null, null, null, -275, null, null, 546, -1583, null, null, null, null, 1987, null, null, null, -1186, 1669, null, null, null, 2584, null, 2705, null, null, -1981, -1407, 556, -930, 2673, null, null, null, null, null, -267, null, null, 1927, 2086, 1381, null, 2003, null, null, null, -606, 1208, 1336, null, -1953, null, null, null, null, 1526, null, null, -99, null, null, 1570, 603, -1193, -1817, null, -1208, null, null, null, null, null, 1332, null, null, null, null, null, null, 1011, null, null, null, null, null, null, null, null, 1590, null, null, null, null, null, 560, null, null, null, null, 2822, 646, -1597, null, 531, null, null, null, -348, null, null, null, null, null, null, 8, null, -604, null, null, null, null, null, null, null, null, null, -600, null, null, null, -1362, null, null, null, null, null, null, null, -1073, null, null, null, 624, 2270, null, 2263, -1, null, null, null, 509, 1789, null, 2671, -1334, null, null, 1780, 130, null, null, null, null, 274, -1565, -1596, 2005, null, 2026, null, null, null, null, null, -1206, null, null, null, 2443, null, null, -973, null, 1514, 1787, 1822, 1626, null, null, 975, 1368, -1131, null, null, null, null, -913, null, null, null, null, 1262, null, null, null, null, null, null, null, null, 2322, null, null, null, null, 2000, null, -1901, null, null, null, null, null, null, null, null, null, null, null, null, null, 2979, null, null, null, null, null, 1230, null, null, null, null, null, null, null, null, null, null, null, null, null, -1572, -1742, null, null, null, null, null, 227, null, null, null, -1906, null, null, -958, 1991, null, 958, null, 779, null, null, -1471, -595, null, null, null, 1941, null, null, null, null, null, null, null, null, null, null, null, null, 1313, null, null, null, null, null, null, null, null, null, 179, null, -1937, -1966, -1172, null, 1551, null, null, null, null, 629, null, 2883, null, 1234, -523, 491, null, -1175, null, null, -1063, null, -969, null, null, null, null, null, -1301};
        TreeNode build2 = TreeUtils.build(nums);
        boolean sameTree = new Question0110().isBalanced(build2);
        System.out.println(sameTree);
    }


    public boolean isBalanced(TreeNode root) {
        if (root == null) {
            return true;
        }
        Integer integer = doIsBalanced(root);
        return integer >= -1;
    }

    /**
     * 深度遍历求树的高度，同时判断树是否平衡
     * 不平衡就返回 -4 ，平衡就返回高度
     * null节点（叶子节点的子节点）的高度为 -1 ，正常节点的高度为 h >= 0
     *
     * @param current
     * @return
     */
    public Integer doIsBalanced(TreeNode current) {
        if (current == null) {
            return -1;
        }
        Integer left = doIsBalanced(current.left);
        Integer right = doIsBalanced(current.right);
        /*  左右子树只要有一个不平衡或者左右子树的高度差>1，就表示当前树不平衡，
         * 不能只判断左右子树的高度差，因为可能左边不平衡返回-4 ，右边高度是 4 ，
         *  这样 Math.abs(left - right) 就不会 > 1 了，但是整个树是不平衡的 */
        if (left == -4 || right == -4 || Math.abs(left - right) > 1) {
            return -4;
        }
        int height = Math.max(left, right) + 1;
        return height;
    }

}
